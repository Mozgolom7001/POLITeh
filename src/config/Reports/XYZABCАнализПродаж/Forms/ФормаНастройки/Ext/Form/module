
////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ ФОРМЫ

Процедура ПриОткрытии()
	
	ОпределитьТипЗначенияОтбораКлассаXYZ();
	
	ОпределитьТипЗначенияОтбораКлассаABC();
	
КонецПроцедуры

////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ ЭЛЕМЕНТОВ УПРАВЛЕНИЯ КОМАНДНОЙ ПАНЕЛИ ФОРМЫ

// Обработчик события Нажатие кнопки КнопкаВыполнить командной панели ОсновныеДействияФормы.
//
Процедура КнопкаВыполнитьНажатие(Элемент)
	
	ЭтаФорма.Закрыть(Истина);
	
КонецПроцедуры

////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ ЭЛЕМЕНТОВ ФОРМЫ

// Обработчик события ПриИзменении элемента формы ИспользоватьСвойстваИКатегории.
//
Процедура ИспользоватьСвойстваИКатегорииПриИзменении(Элемент)

	// Запоминаем текущую настройку
	Настройки = ПостроительОтчета.ПолучитьНастройки(Истина,, Истина);

	// Перезаполнение объекта (с новым текстом запроса)
	ЗаполнитьНачальныеНастройки();

	// Восстанавливаем запомненную настройку
	ПостроительОтчета.УстановитьНастройки(Настройки, Истина,, Истина);
	
КонецПроцедуры

// Обработчик события ПередНачаломДобавления элемента формы Показатели.
//
Процедура ПоказателиПередНачаломДобавления(Элемент, Отказ, Копирование)
	
	Отказ = Истина;
	
КонецПроцедуры

// Обработчик события ПередУдалением элемента формы Показатели.
//
Процедура ПоказателиПередУдалением(Элемент, Отказ)
	
	Отказ = Истина;
	
КонецПроцедуры

// Обработчик события ПриИзменении элемента формы ОбъектАнализа.
//
Процедура ОбъектАнализаПриИзменении(Элемент)

	// Запоминаем текущую настройку
	Настройки = ПостроительОтчета.ПолучитьНастройки(Истина,, Истина);

	// Перезаполнение объекта (с новым текстом запроса)
	ЗаполнитьНачальныеНастройки();

	// Восстанавливаем запомненную настройку
	ПостроительОтчета.УстановитьНастройки(Настройки, Истина,, Истина);
	
	// установим группировку по объекту анализа
	Если ПостроительОтчета.ИзмеренияСтроки.Найти(ОбъектАнализа) = Неопределено Тогда
		ПостроительОтчета.ИзмеренияСтроки.Очистить();
		ПостроительОтчета.ИзмеренияСтроки.Добавить(ОбъектАнализа);	
	КонецЕсли;

КонецПроцедуры

// Обработчик события Нажатие кнопки командной панели КоманднаяПанельПоказатели.УстановитьФлажки.
//
Процедура КоманднаяПанельПоказателиУстановитьФлажки(Кнопка)
	
	Для каждого Строка Из Показатели Цикл
		Строка.Использование = Истина;
	КонецЦикла; 
	
КонецПроцедуры

// Обработчик события Нажатие кнопки командной панели КоманднаяПанельПоказатели.СнятьФлажки.
//
Процедура КоманднаяПанельПоказателиСнятьФлажки(Кнопка)
	
	Для каждого Строка Из Показатели Цикл
		Строка.Использование = Ложь;
	КонецЦикла; 
	
КонецПроцедуры

// Обработчик события ПриИзменении элемента формы ОтборЗначениеКласс.
//
Процедура ОтборЗначениеКлассПриИзменении(Элемент)
	
	ОпределитьТипЗначенияОтбораКлассаXYZ();
	
	ОтборФлагКласс = Истина;
	
КонецПроцедуры

// Обработчик события ПриИзменении элемента формы ОтборЗначениеКласс.
//
Процедура ОтборЗначениеКлассABCПриИзменении(Элемент)
	
	ОпределитьТипЗначенияОтбораКлассаABC();
	
	ОтборФлагКлассABC = Истина;
	
КонецПроцедуры

// Обработчик события ПриИзменении элемента формы ОтборВидСравненияКласс.
//
Процедура ОтборВидСравненияКлассПриИзменении(Элемент)
	
	ОпределитьТипЗначенияОтбораКлассаXYZ();
	
КонецПроцедуры

// Обработчик события ПриИзменении элемента формы ОтборВидСравненияКласс.
//
Процедура ОтборВидСравненияКлассABCПриИзменении(Элемент)
	
	ОпределитьТипЗначенияОтбораКлассаABC();
	
КонецПроцедуры

// Обработчик события ПриИзменении элемента формы ПараметрАнализа.
//
Процедура ПараметрАнализаПриИзменении(Элемент)

	// Запоминаем текущую настройку
	Настройки = ПостроительОтчета.ПолучитьНастройки(Истина,, Истина);

	// Перезаполнение объекта (с новым текстом запроса)
	ЗаполнитьНачальныеНастройки();

	// Восстанавливаем запомненную настройку
	ПостроительОтчета.УстановитьНастройки(Настройки, Истина,, Истина);
	
КонецПроцедуры

// Обработчик события ПриИзменении элемента формы Периодичность.
//
Процедура ПериодичностьПриИзменении(Элемент)

	// Запоминаем текущую настройку
	Настройки = ПостроительОтчета.ПолучитьНастройки(Истина,, Истина);

	// Перезаполнение объекта (с новым текстом запроса)
	ЗаполнитьНачальныеНастройки();

	// Восстанавливаем запомненную настройку
	ПостроительОтчета.УстановитьНастройки(Настройки, Истина,, Истина);
	
КонецПроцедуры

Процедура ГруппыПриВыводеСтроки(Элемент, ОформлениеСтроки, ДанныеСтроки)
	
	ОформлениеСтроки.Ячейки.Использование.ОтображатьТекст = Ложь;
	
КонецПроцедуры

// Обработчик события ПередНачаломИзменения табличного поля ИзмеренияСтроки.
//
Процедура ИзмеренияСтрокиПередНачаломИзменения(Элемент, Отказ)

	ДобавитьСписокТиповГруппировки(ЭлементыФормы.ИзмеренияСтроки.ТекущиеДанные);

КонецПроцедуры // ИзмеренияСтрокиПередНачаломИзменения()

// Обработчик события ПриАктивизацииКолонки табличного поля ИзмеренияСтроки.
//
Процедура ИзмеренияСтрокиПриАктивизацииКолонки(Элемент)

	Если ЭлементыФормы.ИзмеренияСтроки.ТекущаяКолонка <> Неопределено И ЭлементыФормы.ИзмеренияСтроки.ТекущаяКолонка.Имя = "Тип" Тогда
	
		ДобавитьСписокТиповГруппировки(ЭлементыФормы.ИзмеренияСтроки.ТекущиеДанные);
	
	КонецЕсли;

КонецПроцедуры // ИзмеренияСтрокиПриАктивизацииКолонки()

// Процедура добавляет тип измерения для группировки "Элементы"
//
// Параметры
//  ТекущиеДанные элемента формы ИзмеренияСтроки
//
Процедура ДобавитьСписокТиповГруппировки(ИзмеренияСтрокиТекущиеДанные)

	Если ИзмеренияСтрокиТекущиеДанные <> Неопределено Тогда
		ЭлементыФормы.ИзмеренияСтроки.ТекущаяКолонка.ЭлементУправления.СписокВыбора.Очистить();
		ЭлементыФормы.ИзмеренияСтроки.ТекущаяКолонка.ЭлементУправления.СписокВыбора.Добавить(ТипИзмеренияПостроителяОтчета.Элементы);
	КонецЕсли;

КонецПроцедуры // ДобавитьСписокТиповГруппировки()

// Обработчик события ПередУдалением табличного поля Группы.
//
Процедура ГруппыПередУдалением(Элемент, Отказ)

	Отказ = Истина;

КонецПроцедуры // ГруппыПередУдалением()

// Обработчик события ПередНачаломДобавления табличного поля Группы.
//
Процедура ГруппыПередНачаломДобавления(Элемент, Отказ, Копирование)

	Отказ = Истина;

КонецПроцедуры // ГруппыПередНачаломДобавления()


// Заполним список выбора для элемента формы ПараметрАнализа
Для каждого СтрокаТаблицы Из Показатели Цикл
	ЭлементыФормы.ПараметрАнализа.СписокВыбора.Добавить(СтрокаТаблицы.Имя, СтрокаТаблицы.Представление);
КонецЦикла;
//ЭлементыФормы.ПараметрАнализа.СписокВыбора.Добавить("ИнтервалыМеждуРасходнымиДокументами", "Интервалы между расходными документами");

// Заполним список выбора для элемента формы ОбъектАнализа
ЭлементыФормы.ОбъектАнализа.СписокВыбора = мСписокОбъектов;

// Заполним список выбора для элемента формы ОтборВидСравненияКласс
ЭлементыФормы.ОтборВидСравненияКласс.СписокВыбора.Добавить(ВидСравнения.Равно);
ЭлементыФормы.ОтборВидСравненияКласс.СписокВыбора.Добавить(ВидСравнения.НеРавно);
ЭлементыФормы.ОтборВидСравненияКласс.СписокВыбора.Добавить(ВидСравнения.ВСписке);
ЭлементыФормы.ОтборВидСравненияКласс.СписокВыбора.Добавить(ВидСравнения.НеВСписке);

// Заполним список выбора для элемента формы ОтборВидСравненияКлассABC
ЭлементыФормы.ОтборВидСравненияКлассABC.СписокВыбора.Добавить(ВидСравнения.Равно);
ЭлементыФормы.ОтборВидСравненияКлассABC.СписокВыбора.Добавить(ВидСравнения.НеРавно);
ЭлементыФормы.ОтборВидСравненияКлассABC.СписокВыбора.Добавить(ВидСравнения.ВСписке);
ЭлементыФормы.ОтборВидСравненияКлассABC.СписокВыбора.Добавить(ВидСравнения.НеВСписке);

