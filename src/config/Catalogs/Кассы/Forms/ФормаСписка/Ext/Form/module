

// Процедура обновляет заголовок формы по выбранному 
//  владельцу справочника
//
// Параметры: 
//  Нет.
//
// Возвращаемое значение:
//  Нет.
//
Процедура ОбновитьЗаголовок()

	Заголовок = "Список касс организации " + Организация.Наименование

КонецПроцедуры // ОбновитьЗаголовок()

////////////////////////////////////////////////////////////////////////////////
// ПРОЦЕДУРЫ - ОБРАБОТЧИКИ ИЗМЕНЕНИЯ ЗНАЧЕНИЙ РЕКВИЗИТОВ ШАПКИ

// обновляем заголовок формы
Процедура ОрганизацияПриИзменении(Элемент)

	ОбновитьЗаголовок();
	Если Не ЗначениеЗаполнено(Организация) Тогда
		Отбор.Владелец.Установить(Организация, Ложь);
	Иначе	
    	Отбор.Владелец.Установить(Организация, Истина);
	КонецЕсли;	
	
КонецПроцедуры

////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ, ОБЩИХ ДЛЯ ВСЕЙ ФОРМЫ

Процедура ПриОткрытии()
	
	// проставляем организацию пользователя по умолчанию
    Если ПараметрВыборПоВладельцу <> Неопределено Тогда
        Организация = ПараметрВыборПоВладельцу
	КонецЕсли;
    Если ПараметрОтборПоВладельцу <> Неопределено Тогда
        Организация = ПараметрОтборПоВладельцу
	КонецЕсли;
	Если ПараметрТекущаяСтрока = Неопределено Тогда
	    Если Организация.Пустая() Тогда
			Организация = УправлениеПользователями.ПолучитьЗначениеПоУмолчанию(глЗначениеПеременной("глТекущийПользователь"), "ОсновнаяОрганизация");
		КонецЕсли;
	Иначе
		Организация = ПараметрТекущаяСтрока.Владелец;
		ЭлементыФормы.СправочникСписок.ТекущаяСтрока = ПараметрТекущаяСтрока;
	КонецЕсли;
	          
    ОбновитьЗаголовок()
	
КонецПроцедуры

Процедура ПриПовторномОткрытии()

	Если ПараметрВыборПоВладельцу <> Неопределено Тогда
        Организация = ПараметрВыборПоВладельцу
	КонецЕсли;
    Если ПараметрОтборПоВладельцу <> Неопределено Тогда
        Организация = ПараметрОтборПоВладельцу
	КонецЕсли;

	ОбновитьЗаголовок()

КонецПроцедуры

Процедура ПередОткрытием(Отказ, СтандартнаяОбработка)
	
	Если ЗначениеЗаполнено(ПараметрОтборПоВладельцу) Тогда
		ЭлементыФормы.СправочникСписок.Колонки.Владелец.Видимость = Ложь;
	КонецЕсли; 
	
КонецПроцедуры
