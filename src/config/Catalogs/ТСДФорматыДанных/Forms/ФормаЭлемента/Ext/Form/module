
Процедура ДействияФормыРедактироватьКод(Кнопка)
	МеханизмНумерацииОбъектов.ИзменениеВозможностиРедактированияНомера(Метаданные(), ЭтаФорма, ЭлементыФормы.ДействияФормы.Кнопки.Подменю, ЭлементыФормы.Код);
КонецПроцедуры

Процедура ПриОткрытии()
	МеханизмНумерацииОбъектов.УстановитьДоступностьПоляВводаНомера(Метаданные(), ЭтаФорма, ЭлементыФормы.ДействияФормы.Кнопки.Подменю, ЭлементыФормы.Код);
КонецПроцедуры

////////////////////////////////////////////////////////////////////////////////
// ПРОЦЕДУРЫ - ОБРАБОТЧИКИ СОБЫТИЙ ТП СВЯЗЫВАЕМЫЕ ПОЛЯ

// Процедура - обработчик события "ПриНачалеРедактирования" ТП "СвязываемыеПоля"
//
// Параметры
//  Элемент     – <ТабличноеПоле>
//              – ТП, с которым связано событие (СвязываемыеПоля)
//
//  НоваяСтрока – <Булево>
//              – признак редактирования новой строки; имеет значение Истина,
//                если строка была добавлена или скопирована. 
//
//  Копирование – <Булево>
//              – если данный параметр имеет значение Истина, то выполняется
//                копирование строки.
//
Процедура СвязываемыеПоляПриНачалеРедактирования(Элемент, НоваяСтрока, Копирование)

	Если НоваяСтрока Тогда
		ЭлементыФормы.СвязываемыеПоля.ТекущиеДанные.ПолеТСД = 
			ПолучитьСвободноеПолеТСД();
	КонецЕсли;

КонецПроцедуры // СвязываемыеПоляПриНачалеРедактирования()

////////////////////////////////////////////////////////////////////////////////
// ПРОЦЕДУРЫ И ФУНКЦИИ ОБЩЕГО НАЗНАЧЕНИЯ

// Функция возвращает свободное поле ТСД
//
// Параметры
//  Нет
//
// Возвращаемое значение:
//   <Число> – поле ТСД
//
Функция ПолучитьСвободноеПолеТСД()

	Перем Макс;
	
	Макс = 0;
	
	Для Каждого Поля Из СвязываемыеПоля Цикл
		Если Поля.ПолеТСД > Макс Тогда
			Макс = Поля.ПолеТСД;
		КонецЕсли;
	КонецЦикла;
	
	Макс = Макс + 1;
	
	Возврат Макс;
	
КонецФункции // ПолучитьСвободноеПолеТСД()

Процедура ПослеЗаписи()
	МеханизмНумерацииОбъектов.ОбновитьПодсказкуКодНомерОбъекта(ЭтотОбъект.Метаданные(), ЭлементыФормы.ДействияФормы.Кнопки.Подменю, ЭлементыФормы.Код);
КонецПроцедуры

