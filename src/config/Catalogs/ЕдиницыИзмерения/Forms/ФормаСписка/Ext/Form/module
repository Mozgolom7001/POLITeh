////////////////////////////////////////////////////////////////////////////////
// ОБРАБОТЧИКИ СОБЫТИЙ


Процедура ДействияФормыРедактироватьКод(Кнопка)

	МеханизмНумерацииОбъектов.ИзменениеВозможностиРедактированияНомера(Метаданные.Справочники.ЕдиницыИзмерения, ЭтаФорма, ЭлементыФормы.ДействияФормы.Кнопки.Подменю, ЭлементыФормы.СправочникСписок.Колонки.Код);

КонецПроцедуры// Обработчик события ПриОткрытии формы.
//


Процедура ПриОткрытии()

	МеханизмНумерацииОбъектов.УстановитьДоступностьПоляВводаНомера(Метаданные.Справочники.ЕдиницыИзмерения, ЭлементыФормы.СправочникСписок, ЭлементыФормы.ДействияФормы.Кнопки.Подменю, ЭлементыФормы.СправочникСписок.Колонки.Код);

	ЕдиницаИзмеренияВеса = Константы.ЕдиницаИзмеренияВеса.Получить();

	Если НЕ ЗначениеЗаполнено(ЕдиницаИзмеренияВеса) Тогда
		ЭлементыФормы.СправочникСписок.Колонки.Вес.ТекстШапки = "Вес (не назначена единица измерения)";
	Иначе
		ЭлементыФормы.СправочникСписок.Колонки.Вес.ТекстШапки = "Вес (" + СокрЛП(ЕдиницаИзмеренияВеса) +")";
	КонецЕсли;

	ЕдиницаИзмеренияОбъема = Константы.ЕдиницаИзмеренияОбъема.Получить();

	Если НЕ ЗначениеЗаполнено(ЕдиницаИзмеренияОбъема) Тогда
		ЭлементыФормы.СправочникСписок.Колонки.Объем.ТекстШапки = "Объем (не назначена единица измерения)";
	Иначе
		ЭлементыФормы.СправочникСписок.Колонки.Объем.ТекстШапки = "Объем (" + СокрЛП(ЕдиницаИзмеренияОбъема) +")";
	КонецЕсли;

КонецПроцедуры

// Обработчик события ПриНачалеРедактирования элемента СправочникСписок.
//
Процедура СправочникСписокПриНачалеРедактирования(Элемент, НоваяСтрока)

	Если НоваяСтрока Тогда

		Если Элемент.ТекущиеДанные.Коэффициент = 0 Тогда
			Элемент.ТекущиеДанные.Коэффициент = 1;
		КонецЕсли;

		Если НЕ ЗначениеЗаполнено(Элемент.ТекущиеДанные.ЕдиницаПоКлассификатору) Тогда
			Элемент.ТекущиеДанные.ЕдиницаПоКлассификатору = УправлениеПользователями.ПолучитьЗначениеПоУмолчанию(глЗначениеПеременной("глТекущийПользователь"), "ОсновнаяЕдиницаПоКлассификатору");
		КонецЕсли;

	КонецЕсли;

КонецПроцедуры

// Обработчик события ПриИзменении элемента СправочникСписок.ЕдиницаПоКлассификатору.
//
Процедура СправочникСписокЕдиницаПоКлассификаторуПриИзменении(Элемент)

	ТекущиеДанные = ЭлементыФормы.СправочникСписок.ТекущиеДанные;

	Если ПустаяСтрока(ТекущиеДанные.Наименование) Тогда
		ТекущиеДанные.Наименование = СокрЛП(ТекущиеДанные.ЕдиницаПоКлассификатору);
	КонецЕсли;

КонецПроцедуры

 // Обработчик события ПриВыводеСтроки элемента СправочникСписок.
//
Процедура СправочникСписокПриВыводеСтроки(Элемент, ОформлениеСтроки, ДанныеСтроки)

	Если ДанныеСтроки.Владелец = Неопределено Тогда
		ОформлениеСтроки.Ячейки.Коэффициент.ТолькоПросмотр = Ложь;
	Иначе
		ОформлениеСтроки.Ячейки.Коэффициент.ТолькоПросмотр = (ДанныеСтроки.Ссылка = ДанныеСтроки.Владелец.ЕдиницаХраненияОстатков);
	КонецЕсли;

КонецПроцедуры





