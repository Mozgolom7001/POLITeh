Процедура ОбновитьСписокАктивныхСоединений()
	
	АктивныеСоединения.Очистить();
	
	МассивСеансов = ПолучитьСеансыИнформационнойБазы();
	
	Для Каждого Сеанс Из МассивСеансов Цикл
		
		// Текущее соединение не выводится в список.
		Если Сеанс.НомерСеанса = НомерСеансаИнформационнойБазы() Тогда 
			Продолжить;
		КонецЕсли;
		
		ИмяПриложения = Сеанс.ИмяПриложения;
		Если ИмяПриложения = "1CV8" Тогда
			ИмяПриложения = "1С:Предприятие";
		ИначеЕсли ЭтоСеансКонфигуратором(Сеанс) Тогда
			ИмяПриложения = "Конфигуратор";
		ИначеЕсли ЭтоCOMСоединение(Сеанс) Тогда
			ИмяПриложения = "Внешнее соединение";
		КонецЕсли;
			
		НоваяСтрока = АктивныеСоединения.Добавить();
		НоваяСтрока.Пользователь  = ?(Сеанс.Пользователь = Неопределено, "<Не авторизован>", Сеанс.Пользователь.Имя);
		НоваяСтрока.ИмяКомпьютера = Сеанс.ИмяКомпьютера;
		НоваяСтрока.ИмяПриложения = ИмяПриложения;
		
	КонецЦикла;
	
КонецПроцедуры


Процедура КнопкаОКНажатие(Кнопка)
	
	Закрыть();
	
КонецПроцедуры // КнопкаОКНажатие()


Процедура ПриОткрытии()
	
	ОбновитьСписокАктивныхСоединений();
	
	ПодключитьОбработчикОжидания("ОжиданиеЗакрытияСоединений", 3);
	
КонецПроцедуры


Процедура ОжиданиеЗакрытияСоединений()
	
	ОбновитьСписокАктивныхСоединений();
	
КонецПроцедуры 
