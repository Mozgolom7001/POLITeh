
Процедура КоманднаяПанельТаблицыРеализацияЗаполнить();
	
	НастройкаПериода = Новый НастройкаПериода();
	
	Если НастройкаПериода.Редактировать() Тогда
		Запрос = Новый Запрос(" ВЫБРАТЬ РАЗЛИЧНЫЕ Ссылка 
							  |ИЗ
							  |(ВЫБРАТЬ РАЗЛИЧНЫЕ
		                      |	РеализацияТоваровУслугТовары.Ссылка КАК Ссылка
		                      |ИЗ
		                      |	Документ.РеализацияТоваровУслуг.Товары КАК РеализацияТоваровУслугТовары
		                      |ГДЕ
							  |	РеализацияТоваровУслугТовары.Ссылка.Проведен
							  |	И РеализацияТоваровУслугТовары.ССылка.ВидОперации = &Брак
							  |	И РеализацияТоваровУслугТовары.СпособСписанияОстаткаТоваров = &ИзРезерва
							  |ОБЪЕДИНИТЬ ВСЕ
							  |ВЫБРАТЬ РАЗЛИЧНЫЕ
		                      |	РеализацияТоваровУслугТара.Ссылка
		                      |ИЗ
		                      |	Документ.РеализацияТоваровУслуг.ВозвратнаяТара КАК РеализацияТоваровУслугТара
		                      |ГДЕ
							  |	РеализацияТоваровУслугТара.Ссылка.Проведен
							  |	И РеализацияТоваровУслугТара.ССылка.ВидОперации = &Брак
							  |	И РеализацияТоваровУслугТара.СпособСписанияОстаткаТоваров = &ИзРезерва
							  |) КАК СписокДок
							  |");
		Запрос.УстановитьПараметр("НачДата",НастройкаПериода.ДатаНачала);
		Запрос.УстановитьПараметр("КонДата",НастройкаПериода.ДатаОкончания);
		ТекстУсловие = "";
		Если НЕ НастройкаПериода.ВариантНачала = ВариантГраницыИнтервала.БезОграничения Тогда
			ТекстУсловие = ТекстУсловие + ?(ТекстУсловие<>"", " И ", "")+ "
				|	СписокДок.Ссылка.Дата >= &НачДата";
		КонецЕсли;		
		
		Если НЕ НастройкаПериода.ВариантОкончания = ВариантГраницыИнтервала.БезОграничения Тогда
			ТекстУсловие = ТекстУсловие + ?(ТекстУсловие<>"", " И ", "")+ "
				|	СписокДок.Ссылка.Дата <= &КонДата";
		КонецЕсли;		
		Если ТекстУсловие<>"" Тогда
			Запрос.Текст = Запрос.Текст + "ГДЕ "+ТекстУсловие;
		КонецЕсли;
		Запрос.УстановитьПараметр("Брак", Перечисления.ВидыОперацийРеализацияТоваров.Брак);
		Запрос.УстановитьПараметр("ИзРезерва", Перечисления.СпособыСписанияОстаткаТоваров.ИзРезерва);

		Результат = Запрос.Выполнить();
		
		Если Не Результат.Пустой() Тогда
			Выборка = Результат.Выбрать();
			Пока Выборка.Следующий() Цикл
				НоваяСтрока = ТаблицаРеализация.Добавить();
				НоваяСтрока.Документ = Выборка.Ссылка;
			КонецЦикла;
		Иначе
			Сообщить("Документов реализации брака из резерва не обнаружено.");
		КонецЕсли;
	КонецЕсли;	
КонецПроцедуры
